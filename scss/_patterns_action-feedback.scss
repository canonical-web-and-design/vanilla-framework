@import 'settings';

@mixin vf-icon-loader($color) {
  background-image: url("data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8' standalone='no'%3F%3E%3Csvg width='19px' height='19px' viewBox='0 0 19 19' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3C!-- Generator: Sketch 50.2 (55047) - http://www.bohemiancoding.com/sketch --%3E%3Ctitle%3Eicon-determinate%3C/title%3E%3Cdesc%3ECreated with Sketch.%3C/desc%3E%3Cdefs%3E%3C/defs%3E%3Cg id='icon-determinate' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' opacity='0.5'%3E%3Ccircle id='Oval-2' stroke='#{vf-url-friendly-color($color)}' cx='9.5' cy='9.5' r='8.5'%3E%3C/circle%3E%3C/g%3E%3C/svg%3E");
}

@mixin vf-p-action-feedback {
  $button-left-padding: $sp-unit * 1.5;

  %action-feedback-icon {
    height: map-get($icon-sizes, default);
    left: $button-left-padding;
    position: absolute;
    top: $spv-intra--condensed + $spv-nudge - $px;
    width: map-get($icon-sizes, default);
  }

  .p-action-feedback {
    position: relative;

    &::before {
      @extend %action-feedback-icon;
      background-size: map-get($icon-sizes, default);
      content: '';
    }

    &.is-indeterminate,
    &.is-determinate,
    &.is-stepped,
    &.is-done {
      padding-left: $button-left-padding + map-get($icon-sizes, default) + $sph-intra--condensed;
    }

    &.is-indeterminate {
      &::before {
        @include vf-icon-spinner($color-mid-dark);
        animation: spin map-get($animation-duration, sleepy) infinite linear;
      }

      &.p-button--positive::before,
      &.p-button--negative::before {
        @include vf-icon-spinner($color-x-light);
      }
    }

    &.is-determinate {
      &::before {
        @include vf-icon-loader($color-mid-dark);
      }

      &.p-button--positive::before,
      &.p-button--negative::before {
        @include vf-icon-loader($color-x-light);
      }

      & .p-action-feedback__svg {
        display: block;
      }
    }

    &.is-stepped {
      & .p-action-feedback__svg {
        display: block;
      }
    }

    &.is-done {
      &::before {
        @include vf-icon-success($color-positive);
        animation: none;
      }

      &.p-button--positive::before {
        background-image: url("data:image/svg+xml,%3Csvg width='17' height='17' xmlns='http://www.w3.org/2000/svg'%3E%3Cg transform='translate%281 1%29' fill='none' fill-rule='evenodd'%3E%3Ccircle stroke='#{vf-url-friendly-color($color-x-light)}' stroke-width='1.5' fill='#{vf-url-friendly-color($color-x-light)}' cx='7.25' cy='7.25' r='7.25'/%3E%3Cpath fill='#{vf-url-friendly-color($color-positive)}' d='M11.05 4.173l-.066.058L6.25 8.378l-2.776-2.38-.839.948L6.25 10.75l5.5-5.787-.7-.79z'/%3E%3C/g%3E%3C/svg%3E");
      }

      &.p-button--negative::before {
        background-image: url("data:image/svg+xml,%3Csvg width='17' height='17' xmlns='http://www.w3.org/2000/svg'%3E%3Cg transform='translate%281 1%29' fill='none' fill-rule='evenodd'%3E%3Ccircle stroke='#{vf-url-friendly-color($color-x-light)}' stroke-width='1.5' fill='#{vf-url-friendly-color($color-x-light)}' cx='7.25' cy='7.25' r='7.25'/%3E%3Cpath fill='#{vf-url-friendly-color($color-negative)}' d='M11.05 4.173l-.066.058L6.25 8.378l-2.776-2.38-.839.948L6.25 10.75l5.5-5.787-.7-.79z'/%3E%3C/g%3E%3C/svg%3E");
      }
    }

    &.is-cancellable:hover .p-action-feedback__text {
      float: left;
      text-indent: -9999px;

      &::before {
        content: 'Cancel action';
        float: left;
        text-indent: 0;
      }
    }
  }

  .p-action-feedback__svg {
    @extend %action-feedback-icon;
    display: none;
  }

  .p-action-feedback__circle {
    fill: transparent;
    stroke: $color-dark;
    transform: rotate(-90deg);
    transform-origin: 50% 50%;

    .p-button--positive &,
    .p-button--negative & {
      stroke: $color-x-light;
    }
  }
}
